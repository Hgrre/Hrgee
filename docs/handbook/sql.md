## 正则表达式
![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305111157958.webp)


```PHP
# php中使用正则规则一定要加代表正则的标识符`//`

preg_match_all (正则表达式、匹配字符串、匹配到的东西放入数组)
# 返回匹配到的次数

<?php
$a = preg_match_all('/A123/', 'A123A123');
var_dump($a);
?>
 # 输出结果是int(2);


preg_replace (正则表达式、替换成什么、匹配字符串)
# 返回替换后的结果

<?php
$a = preg_replace('/a', '/b', 'aaaccc');
?>
# 输出结果是string(6)"aaaccc";
```

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305111459906.webp)



## 单引号和双引号的区别
* 1：单引号(就代表折纯字符)用于表示字符串的标记在使用单引号的时候，字符串中的任何内容都会被视为普通文本，不会被解释为变量或特殊字符
* 2.双引号会解析字符串中的变量，而在双引号定义的字符串中，它可以转义更多的特殊字符。
* <span style="color: rgb(255, 76, 0);">!!!:</span> 它们之间最大的区别是在于是否会解析变量。很明显以下代码输出双引号是可以解析的，而单引号是不可以解析的。所以在字符处理上单引号要优于双引号。
* 如：
```PHP
<?php
# $a = 'abc';
echo '$a';
?>
# 直接echo'$a',输出的是$a
# 加入一个变量$a,输出的是abc
```

## sql注入
* 本质是把用户输入的数据当作代码执行，也可以理解为用户输入的数据当作sql语句代码执行了。
* 第一个关键条件是用户能够控制输入
* 第二个关键条件是原本程序要执行的代码，拼接了用户输入的数据然后进行执行。
 
判断注入点方法: `and 1=1 (页面正常)  and 1=2 (页面不正常)`
最简单的方法：页面后面加`'`,看页面是否报错
其他方法： 如果是数字型传参，可以尝试-1.如：`?id=1 页面显示id=1 的东西`  `?id=2-1,也是页面显示id=1的东西`如果使用and 1=1 and 1=2 被拦截的可能性太高了，可以尝试`and-1=-1 and-1=-2 and 1>0 or 1=1`



## 检测网页是否存在sql注入
这里以封神台靶场的猫舍为例[点击跳转](http://pu2lh35s.ia.aqlab.cn/)，打开网站的主页中查看url，可以发现网址栏上有一个传参`/?id=1` ,很明显这是一个get传参。也就是说传参的东西很多时候会被拼接进数据库，这个时候我们就要去检测它是否存在sql注入了，

输入/?id=1 , 发现页面是正常的，很明显这是一个get请求，并且他需要传递的参数是id，

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305112259291.webp)

接下来再尝试把id的值改变一下，/?id=2 ,可以看到页面是不正常的，这说明该网站存在sql注入

 ![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305112307694.webp)

在这里还要再区分字符串和代码的区别：
* 如果说and 1=1 被当作代码来执行， and 1=1 没有被代码当作代码来执行，而它只能当作这个id 传参来进行，最后它肯定不会有东西输出。
* 当然在这个时候它有可能会对你id传参进行强制类型转换，如果输入的id是字母，则全被当作0来处理。
* 在这过程如果将你的id传参强制转换为数字，而这个时候有可能会有显示
* 也就是假设`id=1 database`后面无论跟了什么，在强制转换后id是1后面的都会被过滤掉。

当`id=1 and 1=1` 时，按照这个逻辑，提交看看它是否会有反应，1=1是一个恒等式所以它一定满足

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305112319666.webp)

可以看到输入后页面回显正常，那么再进一步试试，当 `id=1 and 1=2` 时会有什么变化，按照代码逻辑这里肯定会报错的。

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305112340035.webp)

页面的信息消失了而且又没有回显，现在就可以确定这里存在sql注入了。

还有一种方法：加单引号 `'` 判断是否存在sql注入，如果单引号报错会使目标暂停报错屏蔽了，就没有数据返回。则说明这里存在sql注入
 
再者在数据库上它也可以达成一个sql运算，它可以直接在rul栏来进行加减乘除。

url是：统一资源标识符（英文Uniform Resource Identifier，URI），它允许用户对网络中的资源通过特定的协议进行交互操作。而+号在这里有特殊的意思，也就是空格的意思。


也就是说url不能直接在id 传参后输+1，因为在get传参的时候它需要经过一次url编码。

在url正常输入+号会被当作空格处理，如果想使用+号可以在url后面的+，`%2b` 才能执行。


还可以使用sleep函数来判断是否存在sql注入。直接输入sleep(10)也就是叫页面休眠10秒钟再返回数据。

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305120009743.webp)

可以看到页面正在加载中，证明我们输入的字符当作被命令执行了，这就是显错注入。


sql注入能干嘛？：1.可以获取管理员账号密码，获取数据库里的信息。


## union 联合查询

含义：(将两条查询语句的结果整合到同一个表输出，两条查询语句的结果的字段数相同)


## 查询数据库的字段

可以使用 `order by` 函数

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305121052316.webp)

可以看到页面有回显，说明该页面就有一个字段，那么再尝试输入3看看会有什么反应

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305121055633.webp)

可以看到在这里页面报错了，说明该页面小于字段3，再试试输入2

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305121057785.webp)

该页面回显正常，证明该页面的表一共有2个字段。

既然知道是两个字段那就好判断了，`union select 1,2`  select 是输出1和2，在这里有一个`,` 逗号它会认为这是一个字段

![Img](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/202305121103791.webp)

可以看到该页面回显正常，则说明这条语句成功执行了。

这里说明一下，数据库输出数据是有选择的，有些字段可能输出了，有些字段可能没有输出


数据库的结构：` 库， 表，字段 ，数据`
`selcet a from admin where id=1` id=1是查询admin 表里的id=1的数据并且只输出a 字段里面的结果


## 查询当前网页的数据库名
数据库名：database()函数；要求两边字段数都相同

















